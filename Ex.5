set.seed(1105)  # Definir a semente para reproduzibilidade

n <- 1180  # Tamanho da amostra
p <- 0.5  # Probabilidade de sucesso

# Função de distribuição acumulada (FDA) da distribuição geométrica
F_x <- function(x, p) {
  ifelse(x >= 0, 1 - (1 - p)^(x + 1), 0)
}

# Simulação da distribuição geométrica usando o método de transformação inversa
simulated_values <- numeric(n)
for (i in 1:n) {
  u <- runif(1)  # Gerar um valor uniforme no intervalo (0, 1)
  x <- 0  # Iniciar o valor simulado de X em 0

  # Verificar se o valor simulado de X é aceito
  while (F_x(x - 1, p) >= u) {
    x <- x + 1
  }

  simulated_values[i] <- x
}

mean_value <- mean(simulated_values)
sd_value <- sd(simulated_values)

# Calcular a proporção de valores simulados que satisfazem a condição
prop <- sum(simulated_values > (mean_value + sd_value)) / sum(simulated_values > mean_value)

prop  # Imprimir a proporção com 4 casas decimais
